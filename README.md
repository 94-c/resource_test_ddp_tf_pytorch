# Resource Test DDP TensorFlow PyTorch

ì´ ì €ì¥ì†ŒëŠ” PyTorchì™€ TensorFlowë¥¼ ì‚¬ìš©í•˜ì—¬ **ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§ ë° ì›Œí¬ë¡œë“œ í…ŒìŠ¤íŠ¸**ë¥¼ ìœ„í•œ ì½”ë“œë¥¼ í¬í•¨í•©ë‹ˆë‹¤. ê° ë¦¬ì†ŒìŠ¤ë³„(CPU, Memory, GPU Memory, GPU Utilization)ë¡œ ì§‘ì¤‘ì ì¸ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ê³ , **DDP ë¶„ì‚° í•™ìŠµ**ì„ í†µí•´ ì‹œìŠ¤í…œì˜ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ“‹ ëª©ì 

- **CPU ì‚¬ìš©ë¥  í…ŒìŠ¤íŠ¸**: í–‰ë ¬ ì—°ì‚°, ë³‘ë ¬ ì²˜ë¦¬ë¥¼ í†µí•œ CPU ì§‘ì•½ì  ì‘ì—…
- **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í…ŒìŠ¤íŠ¸**: ëŒ€ìš©ëŸ‰ í…ì„œ í• ë‹¹ì„ í†µí•œ ë©”ëª¨ë¦¬ ì§‘ì•½ì  ì‘ì—…  
- **GPU ë©”ëª¨ë¦¬ í…ŒìŠ¤íŠ¸**: GPU ë©”ëª¨ë¦¬ í• ë‹¹ ë° ëŒ€ìš©ëŸ‰ ëª¨ë¸ ë¡œë”©
- **GPU ì‚¬ìš©ë¥  í…ŒìŠ¤íŠ¸**: ê³„ì‚° ì§‘ì•½ì  GPU ì—°ì‚°ì„ í†µí•œ GPU í™œìš©ë„ ìµœëŒ€í™”
- **DDP ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸**: ë©€í‹° GPU í™˜ê²½ì—ì„œ ë¶„ì‚° í•™ìŠµì„ í†µí•œ ì¢…í•©ì  ë¦¬ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. ì˜ì¡´ì„± ì„¤ì¹˜

```bash
pip install -r requirements.txt
```

### 2. ê°œë³„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# PyTorch CPU í…ŒìŠ¤íŠ¸ (60ì´ˆê°„)
python run_tests.py pytorch cpu --duration 60

# TensorFlow ë©”ëª¨ë¦¬ í…ŒìŠ¤íŠ¸ (120ì´ˆê°„, í…ì„œ 30ê°œ)
python run_tests.py tensorflow memory --duration 120 --num-tensors 30

# PyTorch GPU ë©”ëª¨ë¦¬ í…ŒìŠ¤íŠ¸
python run_tests.py pytorch gpu_memory --tensor-size 3000

# TensorFlow GPU ì‚¬ìš©ë¥  í…ŒìŠ¤íŠ¸
python run_tests.py tensorflow gpu_utilization --matrix-ops 500

# PyTorch DDP ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸ (NEW!)
python run_tests.py pytorch ddp_training --epochs 50 --batch-size 32
```

### 3. ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# ëª¨ë“  PyTorch í…ŒìŠ¤íŠ¸ ìˆœì°¨ ì‹¤í–‰ (DDP í¬í•¨)
python run_tests.py --all-pytorch --duration 90

# ëª¨ë“  TensorFlow í…ŒìŠ¤íŠ¸ ìˆœì°¨ ì‹¤í–‰
python run_tests.py --all-tensorflow --duration 90
```

### 4. í…ŒìŠ¤íŠ¸ ëª©ë¡ í™•ì¸

```bash
python run_tests.py --list
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
resource_test_ddp_tf_pytorch/
â”œâ”€â”€ README.md                              # í”„ë¡œì íŠ¸ ë¬¸ì„œ
â”œâ”€â”€ requirements.txt                       # ì˜ì¡´ì„± ëª©ë¡
â”œâ”€â”€ run_tests.py                          # ë©”ì¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ MIG_GPU_ë©”íŠ¸ë¦­_ì°¨ì´ì _ì„¤ëª….txt         # MIG í™˜ê²½ GPU ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ (NEW!)
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ resource_monitor.py               # ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§ ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ docs/                                 # ìƒì„¸ ë¬¸ì„œ ë””ë ‰í† ë¦¬ (NEW!)
â”‚   â”œâ”€â”€ MIG_GPU_Utilization_Metrics.md   # MIG GPU ì‚¬ìš©ë¥  ë©”íŠ¸ë¦­ ê³„ì‚° ê°€ì´ë“œ
â”‚   â”œâ”€â”€ prometheus_queries.md            # í”„ë¡œë©”í…Œìš°ìŠ¤ ì¿¼ë¦¬ ëª¨ìŒ
â”‚   â””â”€â”€ grafana_dashboard.json           # Grafana ëŒ€ì‹œë³´ë“œ ì„¤ì •
â”œâ”€â”€ pytorch_tests/
â”‚   â”œâ”€â”€ cpu_test.py                       # PyTorch CPU ì§‘ì•½ì  í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ memory_test.py                    # PyTorch ë©”ëª¨ë¦¬ ì§‘ì•½ì  í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ gpu_memory_test.py               # PyTorch GPU ë©”ëª¨ë¦¬ í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ gpu_utilization_test.py          # PyTorch GPU ì‚¬ìš©ë¥  í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ ddp_training_test.py             # PyTorch DDP ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸ (NEW!)
â””â”€â”€ tensorflow_tests/
    â”œâ”€â”€ cpu_test.py                       # TensorFlow CPU ì§‘ì•½ì  í…ŒìŠ¤íŠ¸
    â”œâ”€â”€ memory_test.py                    # TensorFlow ë©”ëª¨ë¦¬ ì§‘ì•½ì  í…ŒìŠ¤íŠ¸
    â”œâ”€â”€ gpu_memory_test.py               # TensorFlow GPU ë©”ëª¨ë¦¬ í…ŒìŠ¤íŠ¸
    â””â”€â”€ gpu_utilization_test.py          # TensorFlow GPU ì‚¬ìš©ë¥  í…ŒìŠ¤íŠ¸
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ìƒì„¸ ì„¤ëª…

### CPU í…ŒìŠ¤íŠ¸
- **ëª©ì **: CPU ì‚¬ìš©ë¥  ìµœëŒ€í™”
- **ì‘ì—…**: ëŒ€ìš©ëŸ‰ í–‰ë ¬ ì—°ì‚°, ë³‘ë ¬ ì²˜ë¦¬, ìˆ˜í•™ì  ì§‘ì•½ì  ì—°ì‚°
- **ëª¨ë‹ˆí„°ë§**: CPU ì‚¬ìš©ë¥ , ì½”ì–´ë³„ ì‚¬ìš©ëŸ‰

### ë©”ëª¨ë¦¬ í…ŒìŠ¤íŠ¸
- **ëª©ì **: ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœëŒ€í™”
- **ì‘ì—…**: ëŒ€ìš©ëŸ‰ í…ì„œ í• ë‹¹, ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì‹œë®¬ë ˆì´ì…˜, ì ì§„ì  í• ë‹¹
- **ëª¨ë‹ˆí„°ë§**: ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ , ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰(GB)

### GPU ë©”ëª¨ë¦¬ í…ŒìŠ¤íŠ¸
- **ëª©ì **: GPU ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœëŒ€í™”
- **ì‘ì—…**: GPU í…ì„œ í• ë‹¹, ëŒ€ìš©ëŸ‰ ëª¨ë¸ ë¡œë”©, ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸
- **ëª¨ë‹ˆí„°ë§**: GPU ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰(GB), ë‹¤ì¤‘ GPU ì§€ì›

### GPU ì‚¬ìš©ë¥  í…ŒìŠ¤íŠ¸
- **ëª©ì **: GPU ê³„ì‚° ì‚¬ìš©ë¥  ìµœëŒ€í™”
- **ì‘ì—…**: ë³‘ë ¬ í–‰ë ¬ ì—°ì‚°, ì»¨ë³¼ë£¨ì…˜, íŠ¸ëœìŠ¤í¬ë¨¸, FFT ì—°ì‚°
- **ëª¨ë‹ˆí„°ë§**: GPU ì‚¬ìš©ë¥ (%), GPU í™œìš©ë„

### DDP ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸ (NEW!)
- **ëª©ì **: ë©€í‹° GPU í™˜ê²½ì—ì„œ ë¶„ì‚° í•™ìŠµì„ í†µí•œ ì¢…í•©ì  ë¦¬ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸
- **ì‘ì—…**: 
  - LazyFakeDataset ì‚¬ìš© (ì‹¤ì œ ì´ë¯¸ì§€ ëŒ€ì‹  ë¬´ì‘ìœ„ í…ì„œ ìƒì„±)
  - ResNet-50 ëª¨ë¸ ê¸°ë°˜ ë¶„ì‚° í•™ìŠµ
  - 100,000ê°œ ìƒ˜í”Œ, 100 ì—í­ í•™ìŠµ (ì„¤ì • ê°€ëŠ¥)
  - ìë™ ëª¨ë¸ ì €ì¥ (model_final.pth)
- **íŠ¹ì§•**:
  - ë©€í‹° GPU ìë™ ë¶„ì‚° í•™ìŠµ
  - GPU ì—†ì„ ì‹œ CPU ëª¨ë“œ ìë™ ì „í™˜
  - ì‹¤ì‹œê°„ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§
  - ì¤‘ê°„ ì²´í¬í¬ì¸íŠ¸ ìë™ ì €ì¥
- **ëª¨ë‹ˆí„°ë§**: CPU ì½”ì–´ ì‚¬ìš©ëŸ‰, ë©”ëª¨ë¦¬(GB), GPU ë©”ëª¨ë¦¬(GB), GPU ì‚¬ìš©ë¥ (%)

## âš™ï¸ ëª…ë ¹ì¤„ ì˜µì…˜

### ê³µí†µ ì˜µì…˜
- `--duration N`: í…ŒìŠ¤íŠ¸ ì§€ì† ì‹œê°„ (ì´ˆ, ê¸°ë³¸ê°’: 60)
- `--list`: ì‚¬ìš© ê°€ëŠ¥í•œ í…ŒìŠ¤íŠ¸ ëª©ë¡ ì¶œë ¥

### CPU í…ŒìŠ¤íŠ¸ ì˜µì…˜
- `--matrix-iterations N`: í–‰ë ¬ ì—°ì‚° ë°˜ë³µ íšŸìˆ˜
- `--matrix-size N`: í–‰ë ¬ í¬ê¸°
- `--skip-parallel`: ë³‘ë ¬ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸ ê±´ë„ˆë›°ê¸°

### ë©”ëª¨ë¦¬ í…ŒìŠ¤íŠ¸ ì˜µì…˜
- `--num-tensors N`: í• ë‹¹í•  í…ì„œ ìˆ˜
- `--tensor-size N`: í…ì„œ í¬ê¸°
- `--skip-progressive`: ì ì§„ì  í• ë‹¹ í…ŒìŠ¤íŠ¸ ê±´ë„ˆë›°ê¸°

### GPU í…ŒìŠ¤íŠ¸ ì˜µì…˜
- `--stress-level N`: ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸ ë ˆë²¨ (1-5)
- `--skip-conv`: ì»¨ë³¼ë£¨ì…˜ í…ŒìŠ¤íŠ¸ ê±´ë„ˆë›°ê¸°
- `--skip-training`: í•™ìŠµ í…ŒìŠ¤íŠ¸ ê±´ë„ˆë›°ê¸°

### âš¡ ì§‘ì•½ì  GPU í…ŒìŠ¤íŠ¸ (DCGM ë©”íŠ¸ë¦­ ëŒ€ì‘) - NEW!
DCGM (Data Center GPU Manager) ë©”íŠ¸ë¦­ì— ë‚˜íƒ€ë‚˜ë„ë¡ GPU ì‚¬ìš©ë¥ ì„ ì§€ì†ì ìœ¼ë¡œ ë†’ê²Œ ìœ ì§€í•˜ëŠ” ì§‘ì•½ì  í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.
- `--duration N`: í…ŒìŠ¤íŠ¸ ì§€ì† ì‹œê°„ (ì´ˆ, ê¸°ë³¸ê°’: 600ì´ˆ/10ë¶„)
- **ìµœì†Œ ê¶Œì¥ ì‹œê°„**: 10ë¶„ ì´ìƒ (DCGM ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì£¼ê¸° ê³ ë ¤)
- **ì§€ì› ë©”íŠ¸ë¦­**: `DCGM_FI_PROF_GR_ENGINE_ACTIVE`, `DCGM_FI_DEV_GPU_UTIL`
- **ë©€í‹° GPU ì§€ì›**: ëª¨ë“  GPUì—ì„œ ë™ì‹œì— ì›Œí¬ë¡œë“œ ì‹¤í–‰

#### ì§‘ì•½ì  GPU í…ŒìŠ¤íŠ¸ ì‚¬ìš©ë²•
```bash
# ê°„í¸í•œ ì§‘ì•½ì  GPU í…ŒìŠ¤íŠ¸ (10ë¶„ ì´ìƒ)
python run_tests.py --intensive-gpu

# ê°œë³„ í”„ë ˆì„ì›Œí¬ ì§‘ì•½ì  í…ŒìŠ¤íŠ¸ (10ë¶„)
python run_tests.py pytorch gpu_utilization --duration 600
python run_tests.py tensorflow gpu_utilization --duration 600

# ì¥ì‹œê°„ ì§‘ì•½ì  í…ŒìŠ¤íŠ¸ (30ë¶„)
python run_tests.py pytorch gpu_utilization --duration 1800
```

#### ì§‘ì•½ì  GPU í…ŒìŠ¤íŠ¸ íŠ¹ì§•
- **ì§€ì†ì  ë†’ì€ ì‚¬ìš©ë¥ **: GPU ì‚¬ìš©ë¥ ì„ 90% ì´ìƒ ìœ ì§€
- **ë©€í‹° GPU ì§€ì›**: ê° GPUì—ì„œ 2ê°œ ì›Œí¬ë¡œë“œ ìŠ¤ë ˆë“œ ì‹¤í–‰
- **ë‹¤ì–‘í•œ ì—°ì‚°**: ì»¨ë³¼ë£¨ì…˜, íŠ¸ëœìŠ¤í¬ë¨¸, í–‰ë ¬ ì—°ì‚°, FFT ë“± í˜¼í•©
- **ë©”ëª¨ë¦¬ ê´€ë¦¬**: ìë™ ë©”ëª¨ë¦¬ ì••ë°• ë°©ì§€ ë° ë°°ì¹˜ í¬ê¸° ì¡°ì •
- **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**: ë‚¨ì€ ì‹œê°„ ë° ì§„í–‰ ìƒí™© í‘œì‹œ
- **ì•ˆì „í•œ ì¤‘ë‹¨**: Ctrl+Cë¡œ ì–¸ì œë“ ì§€ ì¤‘ë‹¨ ê°€ëŠ¥

### DDP ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸ ì˜µì…˜ (NEW!)
- `--num-samples N`: ë°ì´í„°ì…‹ ìƒ˜í”Œ ìˆ˜ (ê¸°ë³¸ê°’: 100,000)
- `--epochs N`: í•™ìŠµ ì—í­ ìˆ˜ (ê¸°ë³¸ê°’: 100)
- `--batch-size N`: ë°°ì¹˜ í¬ê¸° (ê¸°ë³¸ê°’: 32)
- `--lr FLOAT`: í•™ìŠµë¥  (ê¸°ë³¸ê°’: 0.01)
- `--num-classes N`: í´ë˜ìŠ¤ ìˆ˜ (ê¸°ë³¸ê°’: 100)
- `--save-dir PATH`: ëª¨ë¸ ì €ì¥ ë””ë ‰í† ë¦¬ (ê¸°ë³¸ê°’: ./saved_models)
- `--force-single-gpu`: ë‹¨ì¼ GPU ê°•ì œ ì‚¬ìš©
- `--force-cpu`: CPU ê°•ì œ ì‚¬ìš©

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ê¸°ëŠ¥

ê° í…ŒìŠ¤íŠ¸ëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ë‹¤ìŒ ë¦¬ì†ŒìŠ¤ë¥¼ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤:

- **CPU**: ì‚¬ìš©ë¥ (%), **ì½”ì–´ ì‚¬ìš©ëŸ‰** (ì˜ˆ: 6.33 cores)
- **ë©”ëª¨ë¦¬**: ì‚¬ìš©ë¥ (%), **ì‚¬ìš©ëŸ‰(GB)** (ì˜ˆ: 5.38 GB)
- **GPU**: **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰(GB)** (ì˜ˆ: 2.15 GB), **ì‚¬ìš©ë¥ (%)** (ì˜ˆ: 85.3%)
- **ì‹¤ì‹œê°„ ê·¸ë˜í”„**: í…ŒìŠ¤íŠ¸ ì§„í–‰ ì¤‘ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë³€í™”

### ëª¨ë‹ˆí„°ë§ ì¶œë ¥ ì˜ˆì‹œ
```
==================================================
RESOURCE MONITORING SUMMARY
==================================================
Duration: 172.5 seconds
CPU Usage - Avg: 6.33 cores, Max: 9.32 cores
Memory Usage - Avg: 78.7%, Max: 80.5%
Memory Usage - Avg: 5.38GB, Max: 6.14GB
GPU Usage:
  GPU 0 - Util Avg: 85.3%, Max: 98.1%
  GPU 0 - Memory Avg: 2.15GB, Max: 3.42GB
==================================================
```

## ğŸ“‹ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

### ê¸°ë³¸ ìš”êµ¬ì‚¬í•­
- Python 3.8+
- NumPy
- psutil

### PyTorch í…ŒìŠ¤íŠ¸
- PyTorch >= 2.0.0
- torchvision >= 0.15.0

### TensorFlow í…ŒìŠ¤íŠ¸  
- TensorFlow >= 2.12.0

### GPU í…ŒìŠ¤íŠ¸ (ì„ íƒì‚¬í•­)
- NVIDIA GPU
- CUDA Toolkit
- nvidia-ml-py3
- GPUtil

### DDP ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸
- ë©€í‹° GPU í™˜ê²½ (2ê°œ ì´ìƒ ê¶Œì¥)
- NCCL (GPU ê°„ í†µì‹ )
- ë‹¨ì¼ GPU ë˜ëŠ” CPU ëª¨ë“œë„ ì§€ì›

## ğŸ¯ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### 1. ì‹œìŠ¤í…œ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹
```bash
# ì „ì²´ ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸
python run_tests.py --all-pytorch --duration 300
python run_tests.py --all-tensorflow --duration 300
```

### 2. íŠ¹ì • ë¦¬ì†ŒìŠ¤ ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸
```bash
# CPU ì§‘ì•½ì  ì‘ì—… í…ŒìŠ¤íŠ¸
python run_tests.py pytorch cpu --duration 600 --matrix-size 3000

# GPU ë©”ëª¨ë¦¬ í•œê³„ í…ŒìŠ¤íŠ¸
python run_tests.py pytorch gpu_memory --stress-level 5

# DCGM ë©”íŠ¸ë¦­ ëŒ€ì‘ ì§‘ì•½ì  GPU í…ŒìŠ¤íŠ¸
python run_tests.py --intensive-gpu
```

### 3. ë¶„ì‚° í•™ìŠµ ì›Œí¬ë¡œë“œ í…ŒìŠ¤íŠ¸
```bash
# ë©€í‹° GPU ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸
python run_tests.py pytorch ddp_training --epochs 100 --batch-size 64

# CPU ëª¨ë“œ ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸
python pytorch_tests/ddp_training_test.py --force-cpu --epochs 10

# ë‹¨ì¼ GPU í•™ìŠµ í…ŒìŠ¤íŠ¸
python pytorch_tests/ddp_training_test.py --force-single-gpu --epochs 50
```

### 4. ì›Œí¬ë¡œë“œ ëª¨ë‹ˆí„°ë§
```bash
# ì‹¤ì œ ì›Œí¬ë¡œë“œì™€ ìœ ì‚¬í•œ íŒ¨í„´ìœ¼ë¡œ í…ŒìŠ¤íŠ¸
python run_tests.py tensorflow gpu_utilization --conv-iterations 1000

# DCGM ë©”íŠ¸ë¦­ ìˆ˜ì§‘ì„ ìœ„í•œ ì¥ì‹œê°„ ì§‘ì•½ì  í…ŒìŠ¤íŠ¸
python run_tests.py pytorch gpu_utilization --duration 1800  # 30ë¶„
```

## ğŸ”§ ê°œë°œì ê°€ì´ë“œ

### ìƒˆë¡œìš´ í…ŒìŠ¤íŠ¸ ì¶”ê°€
1. `pytorch_tests/` ë˜ëŠ” `tensorflow_tests/` ë””ë ‰í† ë¦¬ì— ìƒˆ í…ŒìŠ¤íŠ¸ íŒŒì¼ ìƒì„±
2. `utils/resource_monitor.py`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§ êµ¬í˜„
3. `run_tests.py`ì˜ í…ŒìŠ¤íŠ¸ ëª©ë¡ì— ìƒˆ í…ŒìŠ¤íŠ¸ ì¶”ê°€

### ì»¤ìŠ¤í…€ ëª¨ë‹ˆí„°ë§
`ResourceMonitor` í´ë˜ìŠ¤ë¥¼ í™•ì¥í•˜ì—¬ ì¶”ê°€ ë©”íŠ¸ë¦­ ëª¨ë‹ˆí„°ë§ ê°€ëŠ¥:

```python
from utils.resource_monitor import ResourceMonitor

monitor = ResourceMonitor(interval=0.5)
monitor.start_monitoring()
# ... í…ŒìŠ¤íŠ¸ ì½”ë“œ ...
monitor.stop_monitoring()
monitor.print_summary()
```

### LazyFakeDataset ì‚¬ìš©ë²•
```python
from pytorch_tests.ddp_training_test import LazyFakeDataset

# ê°€ì§œ ë°ì´í„°ì…‹ ìƒì„± (ë©”ëª¨ë¦¬ íš¨ìœ¨ì )
dataset = LazyFakeDataset(
    num_samples=10000,
    image_size=(3, 224, 224),
    num_classes=100
)
```

## ğŸ“ˆ ì¶œë ¥ ì˜ˆì‹œ

### ì¼ë°˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```
ğŸ§ª ë¦¬ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ê¸°
PyTorchì™€ TensorFlowë¥¼ ì‚¬ìš©í•œ CPU, ë©”ëª¨ë¦¬, GPU ë¦¬ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸
============================================================

ğŸš€ ì‹¤í–‰ ì¤‘: pytorch_tests/cpu_test.py
   ëª…ë ¹ì–´: python pytorch_tests/cpu_test.py --duration 60

ğŸ’» ì‹œìŠ¤í…œ ì •ë³´:
  OS: macOS 14.0
  CPU: Apple M2 Pro (12 ì½”ì–´)
  Memory: 32.0 GB
  GPU: Apple M2 Pro

ğŸ”¥ PyTorch CPU ì§‘ì•½ì  í…ŒìŠ¤íŠ¸ ì‹œì‘ (ì§€ì† ì‹œê°„: 60ì´ˆ)
============================================================

1. í–‰ë ¬ ì—°ì‚° í…ŒìŠ¤íŠ¸
  ë°˜ë³µ 0/100 ì™„ë£Œ
  ë°˜ë³µ 20/100 ì™„ë£Œ
  ...

ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§ ìš”ì•½:
  í‰ê·  CPU ì‚¬ìš©ë¥ : 87.3%
  ìµœëŒ€ CPU ì‚¬ìš©ë¥ : 95.2%
  í‰ê·  ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ : 45.1%
  í…ŒìŠ¤íŠ¸ ì§€ì† ì‹œê°„: 60.2ì´ˆ

âœ… í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!
```

### ì§‘ì•½ì  GPU í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (DCGM ë©”íŠ¸ë¦­ ëŒ€ì‘)
```
ğŸ§ª ë¦¬ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ê¸°
PyTorchì™€ TensorFlowë¥¼ ì‚¬ìš©í•œ CPU, ë©”ëª¨ë¦¬, GPU ë¦¬ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸
============================================================

ğŸ”¥ ì§‘ì•½ì  GPU í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤...
   DCGM_FI_PROF_GR_ENGINE_ACTIVE ë©”íŠ¸ë¦­ì— ë‚˜íƒ€ë‚˜ë„ë¡ 10ë¶„ ì´ìƒ ì‹¤í–‰ë©ë‹ˆë‹¤.
   Ctrl+Cë¡œ ì¤‘ë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

============================================================
PyTorch GPU ì§‘ì•½ì  í…ŒìŠ¤íŠ¸ ì‹œì‘
============================================================

ğŸš€ ì‹¤í–‰ ì¤‘: pytorch_tests/gpu_utilization_test.py
   ëª…ë ¹ì–´: python pytorch_tests/gpu_utilization_test.py --duration 600

ğŸ’» ì‹œìŠ¤í…œ ì •ë³´:
  OS: Linux 5.4.0
  CPU: Intel Xeon Gold 6230 (40 ì½”ì–´)
  Memory: 512.0 GB
  GPU: NVIDIA A100 80GB (4ê°œ)

ğŸ® GPU ì •ë³´:
  GPU 0: NVIDIA A100 80GB PCIe
    ë©”ëª¨ë¦¬: 81.0 GB
    ë©€í‹°í”„ë¡œì„¸ì„œ: 108
  GPU 1: NVIDIA A100 80GB PCIe
    ë©”ëª¨ë¦¬: 81.0 GB
    ë©€í‹°í”„ë¡œì„¸ì„œ: 108
  [...]

ğŸ¯ 4ê°œ GPUì—ì„œ 10ë¶„ ë™ì•ˆ ì§‘ì•½ì  ì›Œí¬ë¡œë“œ ì‹œì‘
   DCGM_FI_PROF_GR_ENGINE_ACTIVE ë©”íŠ¸ë¦­ì— ë‚˜íƒ€ë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...
============================================================

ğŸš€ GPU 0 ì›Œí¬ë¡œë“œ 0 ì‹œì‘
ğŸš€ GPU 0 ì›Œí¬ë¡œë“œ 1 ì‹œì‘
ğŸš€ GPU 1 ì›Œí¬ë¡œë“œ 0 ì‹œì‘
ğŸš€ GPU 1 ì›Œí¬ë¡œë“œ 1 ì‹œì‘
[...]

  GPU 0 ì›Œí¬ë¡œë“œ 0: 20 ë°˜ë³µ ì™„ë£Œ, ë‚¨ì€ ì‹œê°„: 538.2ì´ˆ, Loss: 4.6823
  GPU 1 ì›Œí¬ë¡œë“œ 0: 18 ë°˜ë³µ ì™„ë£Œ, ë‚¨ì€ ì‹œê°„: 541.8ì´ˆ, Loss: 4.7291
  GPU 0 ì›Œí¬ë¡œë“œ 1: 19 ë°˜ë³µ ì™„ë£Œ, ë‚¨ì€ ì‹œê°„: 540.1ì´ˆ, Loss: 4.6547
  [...]

â±ï¸  ì§„í–‰ ì¤‘... ë‚¨ì€ ì‹œê°„: 480.3ì´ˆ
â±ï¸  ì§„í–‰ ì¤‘... ë‚¨ì€ ì‹œê°„: 470.1ì´ˆ
[...]

âœ… GPU 0 ì›Œí¬ë¡œë“œ 0 ì™„ë£Œ (156 ë°˜ë³µ)
âœ… GPU 0 ì›Œí¬ë¡œë“œ 1 ì™„ë£Œ (148 ë°˜ë³µ)
âœ… GPU 1 ì›Œí¬ë¡œë“œ 0 ì™„ë£Œ (152 ë°˜ë³µ)
âœ… GPU 1 ì›Œí¬ë¡œë“œ 1 ì™„ë£Œ (145 ë°˜ë³µ)
[...]

ğŸ ëª¨ë“  GPU ì›Œí¬ë¡œë“œ ì™„ë£Œ

==================================================
RESOURCE MONITORING SUMMARY
==================================================
Duration: 600.2 seconds
CPU Usage - Avg: 18.7 cores, Max: 28.4 cores
Memory Usage - Avg: 87.3%, Max: 91.2%
Memory Usage - Avg: 448.2GB, Max: 467.1GB
GPU Usage:
  GPU 0 - Util Avg: 94.8%, Max: 99.2%
  GPU 0 - Memory Avg: 72.1GB, Max: 78.9GB
  GPU 1 - Util Avg: 93.1%, Max: 98.7%
  GPU 1 - Memory Avg: 71.8GB, Max: 78.4GB
  [...]
==================================================

ğŸ¯ PyTorch GPU ì‚¬ìš©ë¥  ì§‘ì•½ì  í…ŒìŠ¤íŠ¸ ì™„ë£Œ!
   ì´ ì‹¤í–‰ ì‹œê°„: 600.2ì´ˆ
============================================================

âœ… ëª¨ë“  ì§‘ì•½ì  GPU í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!
```

### DDP ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```
ğŸš€ 2ê°œ GPUë¡œ DDP í•™ìŠµ ì‹œì‘
============================================================
Running DDP training on rank 0
Running DDP training on rank 1

ğŸ”¥ PyTorch DDP í•™ìŠµ ì‹œì‘ (GPU 2ê°œ ì‚¬ìš©)
   ìƒ˜í”Œ ìˆ˜: 100,000
   ì—í­ ìˆ˜: 100
   ë°°ì¹˜ í¬ê¸°: 32
   í´ë˜ìŠ¤ ìˆ˜: 100
   ë””ë°”ì´ìŠ¤: cuda:0
============================================================

âœ… Epoch 1/100 ì™„ë£Œ - í‰ê·  Loss: 4.8756, ì‹œê°„: 45.32ì´ˆ
ğŸ¯ ëª¨ë¸ ì €ì¥ ì™„ë£Œ: ./saved_models/model_final.pth

âœ… DDP í•™ìŠµì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!
```

## ğŸ“¦ ì €ì¥ëœ íŒŒì¼

DDP ë¶„ì‚° í•™ìŠµ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œ ë‹¤ìŒ íŒŒì¼ë“¤ì´ ìƒì„±ë©ë‹ˆë‹¤:

- `saved_models/model_final.pth`: ìµœì¢… í•™ìŠµëœ ëª¨ë¸
- `saved_models/checkpoint_epoch_*.pth`: ì¤‘ê°„ ì²´í¬í¬ì¸íŠ¸ë“¤ (10 ì—í­ë§ˆë‹¤)

## ğŸ“š ì¶”ê°€ ë¬¸ì„œ

### MIG í™˜ê²½ GPU ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ
MIG(Multi-Instance GPU) í™˜ê²½ì—ì„œ GPU ì‚¬ìš©ë¥  ë©”íŠ¸ë¦­ì„ ì •í™•íˆ ì´í•´í•˜ê³  ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë°©ë²•:

ğŸ“„ **[MIG GPU ë©”íŠ¸ë¦­ ì°¨ì´ì  ì„¤ëª…](./MIG_GPU_ë©”íŠ¸ë¦­_ì°¨ì´ì _ì„¤ëª….txt)**
- ë‹¨ìˆœ í‰ê·  vs ê°€ì¤‘ í‰ê·  ê³„ì‚°ì˜ ì°¨ì´ì 
- ì‹¤ë¬´ì—ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ ì¿¼ë¦¬ í™œìš©ë²•
- DCGM ë©”íŠ¸ë¦­ ì •í™•í•œ í•´ì„ ë°©ë²•
- êµ¬ì²´ì ì¸ ì˜ˆì‹œì™€ ì‹¤ì „ íŒ ì œê³µ

ğŸ“ **[ìƒì„¸ ë¬¸ì„œ ë””ë ‰í† ë¦¬](./docs/)**
- **[MIG GPU ì‚¬ìš©ë¥  ë©”íŠ¸ë¦­ ê³„ì‚° ê°€ì´ë“œ](./docs/MIG_GPU_Utilization_Metrics.md)** - ì™„ì „í•œ ê¸°ìˆ  ë¬¸ì„œ
- **[í”„ë¡œë©”í…Œìš°ìŠ¤ ì¿¼ë¦¬ ëª¨ìŒ](./docs/prometheus_queries.md)** - ì‹¤ì œ ì‚¬ìš© ê°€ëŠ¥í•œ ì¿¼ë¦¬ë“¤
- **[Grafana ëŒ€ì‹œë³´ë“œ ì„¤ì •](./docs/grafana_dashboard.json)** - ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ëŒ€ì‹œë³´ë“œ

> **ğŸ’¡ TIP**: MIG í™˜ê²½ì—ì„œëŠ” ë‹¨ìˆœ í‰ê· ë³´ë‹¤ **ê°€ì¤‘ í‰ê· **ì„ ì‚¬ìš©í•´ì•¼ ì‹¤ì œ GPU ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì„ ì •í™•íˆ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ”§ ë¬¸ì œ í•´ê²° (Troubleshooting)

### NVML/CUDA ì˜¤ë¥˜ í•´ê²° (ì»¨í…Œì´ë„ˆ í™˜ê²½)

#### 1. NVML_SUCCESS ì˜¤ë¥˜ í•´ê²°
```bash
# ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì‹œ ë‹¤ìŒ ì˜µì…˜ ì¶”ê°€
docker run --gpus all --privileged \
  -e NVIDIA_DISABLE_REQUIRE=1 \
  -e CUDA_LAUNCH_BLOCKING=1 \
  -v /usr/lib/x86_64-linux-gnu/libnvidia-ml.so:/usr/lib/x86_64-linux-gnu/libnvidia-ml.so \
  your-container-image

# ë˜ëŠ” ë” ì•ˆì „í•œ GPU í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python run_tests.py pytorch gpu_utilization --duration 300  # ë” ì§§ì€ ì‹œê°„
```

#### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
```bash
# GPU ë©”ëª¨ë¦¬ ê´€ë¦¬ ìµœì í™”
export PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512
export CUDA_LAUNCH_BLOCKING=1

# NVML ë¹„í™œì„±í™” (ëª¨ë‹ˆí„°ë§ ì œí•œ)
export NVIDIA_DISABLE_REQUIRE=1
```

#### 3. ì•ˆì „í•œ ì§‘ì•½ì  GPU í…ŒìŠ¤íŠ¸
```bash
# ë‹¨ì¼ GPU, ì§§ì€ ì‹œê°„ í…ŒìŠ¤íŠ¸
python pytorch_tests/gpu_utilization_test.py --duration 300

# ë°°ì¹˜ í¬ê¸° ì œí•œ ë²„ì „
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:256 python run_tests.py pytorch gpu_utilization --duration 600
```

#### 4. ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì˜ˆì‹œ (NGC PyTorch)
```bash
docker run --gpus all --rm -it \
  --shm-size=16g \
  --ulimit memlock=-1 \
  --ulimit stack=67108864 \
  -e PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512 \
  -v $(pwd):/workspace \
  nvcr.io/nvidia/pytorch:23.07-py3
```

## ğŸ“‹ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
